private namespace staging.vxii.test.stac.basic
   version 1.0;

define observation somewhere_in_greece_at_50m as {
	semantics: earth:Terrestrial earth:Region
	space: {
		shape: "EPSG:4326 POLYGON ((21.910616123751442 38.79364335500986, 21.26838806193504 38.79364335500986, 21.26838806193504 39.03962334822924, 21.910616123751442 39.03962334822924, 21.910616123751442 38.79364335500986))"
		grid: 50.m
	}
	time: {
		start: 2024
      end: 2025
      step: 1.year
	}
};

// This one has persist: true, which creates a temporary resource at the resolver's 
define observation pc_io_lulc_stac_session as {
	semantics: {{ geography:BathymetricDepth in m}} // not really what this resource represents
	contextualization: {
		adapter: stac
		collection: "https://planetarycomputer.microsoft.com/api/stac/v1/collections/io-lulc-annual-v02"
		asset: "data"
		persist: true
	}
};


// This one has persistence and resource configuration, which contributes to a resource
// Submitting user must have resource create/update permissions + anu permissions needed 
// for the specific resource in case of merging and updating.
define observation pc_io_lulc_stac_resource as {
	semantics: {{ geography:BathymetricDepth in m}} // not really what this resource represents
	contextualization: {
		adapter: stac
		collection: "https://planetarycomputer.microsoft.com/api/stac/v1/collections/io-lulc-annual-v02"
		asset: "data"
		persist: true // false will deactivate the resource configuration below
		resource: {
			service: ferdinando.villa    // optional (use service that has it or first service 
			                         // with upload rights) unless merge is specified
			catalog: vito.ml         // mandatory. If resource does not exist, only 'staging' is
			                         // accepted.
			namespace: lulc.global   // mandatory
			id: "io-lulc-annual-v02" // optional (use resource ID from adapter)
			mode: update // optional (default=override). Can be: 
					     //     replace  (delete any previously existing resource);
					     //     update   (post next version if existing, keeping history) 
			             //     merge    (merge content with existing if adapter allows) 
						 //     add      (skip if already existing)
		}
	}
};


// FIXME - the name is the same and there is no URL correction or error checking
// Should require explicit name rather than use numbering

// This works in 0.11 with the above context (maybe)
model ferdinando.villa:staging:im.data.global:jrc_global_surface_water_transition
	as geography:Slope in degree_angle;

// This should work for real (it's LULC, so should be classified)
model ferdinando.villa:staging:im.data.global:impact.observatory.annual.landuse
	as geography:Slope in degree_angle;